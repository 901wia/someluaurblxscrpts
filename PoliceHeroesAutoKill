local RS = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local LP = Players.LocalPlayer
local Event = RS:WaitForChild("Event")

local TOGGLE_KEY = Enum.KeyCode.F
local ENEMY_TEAMS = {"Heroes", "Police"}
local BEAMS_PER_PART = 100

local Enabled = false
local Conn

local function isEnemy(p) 
    if p == LP or not p.Team then return false end
    for _, t in ENEMY_TEAMS do if p.Team.Name == t then return true end end
    return false
end

local function fire(pos)
    for i = 1, BEAMS_PER_PART do
        task.spawn(function() Event:FireServer("BM", pos) end)
    end
end

local function killLoop()
    if Conn then Conn:Disconnect() end
    Conn = game:GetService("RunService").Heartbeat:Connect(function()
        if not Enabled then return end
        for _, plr in Players:GetPlayers() do
            if isEnemy(plr) and plr.Character then
                local head = plr.Character:FindFirstChild("Head")
                local hrp = plr.Character:FindFirstChild("HumanoidRootPart")
                if head then fire(head.Position) end
                if hrp then fire(hrp.Position) end
            end
        end
    end)
end

UIS.InputBegan:Connect(function(i,gp)
    if gp or i.KeyCode ~= TOGGLE_KEY then return end
    Enabled = not Enabled
    if Enabled then killLoop() print("Heroes & Police Killer: ON") else if Conn then Conn:Disconnect() end print("Heroes & Police Killer: OFF") end
end)

print("Heroes & Police Killer Loaded | Press F to toggle")
